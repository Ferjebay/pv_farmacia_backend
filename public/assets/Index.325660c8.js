import{l as qe,m as Fe,n as Ue,p as ke,d as ae,r as d,_ as te,o as L,c as x,f as a,g as s,ac as h,aU as ce,h as P,aV as Ee,a as ie,C as ne,ae as J,aW as ee,Y as oe,e as t,Q as p,i as H,w as se,ad as w,aX as ve,aT as W,ag as ge,aa as G,u as Me,t as Le,ab as X,P as re,aY as Ie}from"./index.e02e0fd9.js";import{Q as de}from"./QSpace.290b7cf2.js";import{Q as Se,a as E}from"./QTable.7676999b.js";import{Q as De}from"./QBadge.5c85781b.js";import{Q as je}from"./QPage.b9acbce1.js";import{Q as Te}from"./QPageSticky.51a05daf.js";import{d as Oe}from"./date.cb1dcd19.js";import{u as _e,a as Qe}from"./useHelpers.6f57171d.js";import{A as C,u as ue}from"./Api.e3a65a9d.js";import{d as K,Q as Z,e as I}from"./QList.ffb79e57.js";import{Q as Ae,a as be,C as le}from"./ClosePopup.a58b803f.js";import{Q as Ve}from"./QForm.0c336d83.js";import{A as Ne}from"./Add.b6df10bc.js";import{A as Re}from"./Add.02555e45.js";import{A as Be}from"./Add.d7792b6c.js";import{u as ze}from"./useRolPermisos.82749469.js";import"./index.2cf0d985.js";var Je=qe({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:o}){const f=Fe(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>Ue("tr",{class:f.value},ke(o.default))}});const Ge=ae({name:"FiltrarArticulo",props:["pagination","formFiltrarArticulo","user"],setup(e,{emit:o}){const f=d(!1),v=d([]),u=async()=>{try{const{data:{puntos_ventas:i}}=await C.get("/puntos_ventas/true");v.value=[],v.value.push({label:"Todos",value:0}),i.forEach(m=>{m.estado=="1"&&m.nombre!="OTROS-JEFE"&&v.value.push({label:m.nombre,value:m.id})})}catch(i){console.log(i)}f.value=!1},F=async()=>{e.formFiltrarArticulo.page=(e.pagination.page-1)*e.pagination.rowsPerPage,e.formFiltrarArticulo.rowsPerPage=e.pagination.rowsPerPage,f.value=!0;const{data:i}=await C.post("/articulos/contarArticulos",e.formFiltrarArticulo);f.value=!1,o("actualizarLista",i)};return u(),{contarArticulos:F,listPV:v,loading:f}}});function xe(e,o,f,v,u,F){return L(),x("div",{class:Ee(["col-md-10 col-xs-12 flex items-center",e.$q.screen.xs?"justify-center":""])},[a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",style:ce([{width:"36%","margin-left":"27px"},e.$q.screen.xs?"width: 52%; margin-right: 0px; margin-top:30px":""]),modelValue:e.formFiltrarArticulo.pv_id,"onUpdate:modelValue":o[0]||(o[0]=i=>e.formFiltrarArticulo.pv_id=i),options:e.listPV,label:"Filtar por punto de Venta"},{"no-option":s(()=>[a(K,null,{default:s(()=>[a(Z,{class:"text-grey"},{default:s(()=>[h(" No hay resultados ")]),_:1})]),_:1})]),_:1},8,["style","modelValue","options"]),a(P,{round:"",color:"black",icon:"search",loading:e.loading,style:ce(e.$q.screen.xs?"margin-top:30px;":""),class:"q-ml-md",onClick:e.contarArticulos},null,8,["loading","style","onClick"])],2)}var He=te(Ge,[["render",xe]]);let me=[],pe=[],fe=[];const We=ae({name:"AgregarArticulo",components:{AddPresentation:Ne,AddLaboratorio:Re,AddCategoria:Be},emits:["actualizarLista"],setup(e,{emit:o}){const f=ue(),{claim:{user:v}}=ie.read(f.token),u=d({punto_agregar:"",cod_barra:"",iva:"",principio_activo:"",producto:"",categoria_id:"",presentacion_id:"",laboratorio_id:"",f_caja:1,f_total:0,fecha_caducidad:"",pvm:0,pvp:0,p_unitario:0,descuento:0}),F=d(0),i=d(0),m=d([]),V=d([]),l=d([]),U=d([]),$=d(!1),T=d(!1),S=d(!1),Q=d(!1),N=()=>{const r=(u.value.pvp/u.value.f_caja).toFixed(2),n=Math.floor(r*100)/100;u.value.p_unitario=n},O=()=>{const r=u.value.f_total,n=u.value.f_caja;F.value=r!==0?parseInt(r/n):0,i.value=r!==0?parseInt(r%n):0},{mostrarNotify:_}=_e(),R=async()=>{try{S.value=!1;const{data:{laboratorios:r}}=await C.get("/laboratorios/true");m.value=[],r.forEach(n=>{m.value.push({label:n.nombre,value:n.id})}),fe=m.value}catch(r){console.log(r)}},B=async()=>{try{Q.value=!1;const{data:{categorias:r}}=await C.get("/categorias/true");V.value=[],r.forEach(n=>{V.value.push({label:n.nombre,value:n.id})}),pe=V.value}catch(r){console.log(r)}$.value=!1},j=async()=>{try{T.value=!1;const{data:{presentaciones:r}}=await C.get("/presentaciones/true");l.value=[],r.forEach(n=>{l.value.push({label:n.nombre,value:n.id})}),me=l.value}catch(r){console.log(r)}$.value=!1},D=async()=>{try{const{data:{puntos_ventas:r}}=await C.get("/puntos_ventas/true");U.value=[],r.forEach(n=>{n.nombre!="OTROS-JEFE"&&U.value.push({label:n.nombre,value:n.id})}),U.value.unshift({label:"AGREGAR A TODOS",value:0})}catch(r){console.log(r)}$.value=!1};j(),R(),B(),D();const q=async()=>{try{$.value=!0,u.value.rol_name=v.rol_name,u.value.empresa_id=v.empresa_id;let r=0;v.rol_name=="ADMINISTRADOR"||v.rol_name=="SUPER-ADMINISTRADOR"?r=f.pv_selected_admin:r=v.pv_id,u.value.pv_id=r,await C.post("/articulos",u.value),o("actualizarLista","saludos"),_("positive","Articulos Agregados Exitosamente"),$.value=!1}catch(r){console.log(r),$.value=!1}};return ne(u.value,(r,n)=>{u.value.producto=r.producto.toUpperCase()}),{calcularPrecioUnit:N,listLaboratorios:m,listCategorias:V,listPresentaciones:l,listPV:U,loading:$,formArticulo:u,getPresentaciones:j,getLaboratorios:R,getCategorias:B,modalAgregarPresentacion:T,modalAgregarLaboratorio:S,modalAgregarCategoria:Q,submit:q,totalCajas:F,totalFracciones:i,cajasAndFracciones:O,user:v,myLocale:{days:"Domingo_Lunes_Martes_Mi\xE9rcoles_Jueves_Viernes_S\xE1bado".split("_"),daysShort:"Dom_Lun_Mar_Mi\xE9_Jue_Vie_S\xE1b".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1,format24h:!0,pluralDay:"dias"},filterFn(r,n){if(r===""){n(()=>{l.value=me});return}n(()=>{const A=r.toLowerCase();l.value=l.value.filter(y=>y.label.toLowerCase().indexOf(A)>-1)})},filterFnCategories(r,n){if(r===""){n(()=>{V.value=pe});return}n(()=>{const A=r.toLowerCase();V.value=V.value.filter(y=>y.label.toLowerCase().indexOf(A)>-1)})},filterFnLaboratorios(r,n){if(r===""){n(()=>{m.value=fe});return}n(()=>{const A=r.toLowerCase();m.value=m.value.filter(y=>y.label.toLowerCase().indexOf(A)>-1)})}}}}),Ye=t("div",{class:"text-h6 text-center"},"Agregar Articulo(s)",-1),Xe={class:"row q-gutter-md"},Ke={class:"offset-1 col-xs-10 col-sm-4"},Ze=t("label",null,"Codigo de Barra:",-1),eo={class:"col-xs-10 col-sm-3"},oo=t("label",null,"Aplica IVA:",-1),lo={class:"col-xs-10 col-sm-3"},ao=t("label",null,"Fecha de Caducidad:",-1),to={class:"row items-center justify-end"},so={class:"offset-1 col-xs-10 col-sm-5"},ro=t("label",null,"Principio Activo:",-1),io={class:"col-xs-10 col-sm-5"},no=t("label",null,"Producto:",-1),uo={class:"offset-1 col-xs-10 col-sm-5"},co=t("label",null,"Categoria:",-1),mo={class:"col-xs-10 col-sm-5"},po=t("label",null,"Laboratorio:",-1),fo={class:"offset-1 col-xs-10 col-sm-5"},vo=t("label",null,"Presentaci\xF3n:",-1),go={class:"col-xs-10 col-sm-5 text-center"},_o=t("label",null,"PV a agregar:",-1),Ao={class:"offset-1 col-xs-10 col-sm-4",style:{display:"flex","align-items":"center","justify-content":"center"}},bo={class:"text-h5 q-mt-sm"},Vo=t("span",{class:"text-green-10"},"C:",-1),yo={class:"text-weight-regular"},ho={class:"q-ml-xl"},wo=t("span",{class:"text-green-10"},"F:",-1),$o={class:"text-weight-regular"},Po={class:"col-xs-10 col-sm-2"},Co=t("label",null,"F. por caja:",-1),qo={class:"col-xs-10 col-sm-3"},Fo=t("label",null,"Stock Fracciones:",-1),Uo={class:"row q-gutter-md flex-center text-center"},ko={class:"col-xs-10 col-sm-2"},Eo=t("label",null,"PVM:",-1),Mo={class:"col-xs-10 col-sm-2 text-center"},Lo=t("label",null,"PVP:",-1),Io={class:"col-xs-10 col-sm-2 text-center"},So=t("label",null,"P. Unitario:",-1),Do={class:"col-xs-10 col-sm-2"},jo=t("label",null,"Descuento %",-1),To={class:"col-xs-9 col-sm-12 flex justify-center"};function Oo(e,o,f,v,u,F){const i=J("AddPresentation"),m=J("AddLaboratorio"),V=J("AddCategoria");return L(),x(ge,null,[a(ve,{style:{width:"700px","max-width":"80vw"}},{default:s(()=>[a(ee,{class:"row items-center q-pb-none text-center"},{default:s(()=>[Ye,a(de),oe(a(P,{icon:"close",flat:"",round:"",dense:""},null,512),[[le]])]),_:1}),a(ee,null,{default:s(()=>[a(Ve,null,{default:s(()=>[t("div",Xe,[t("div",Ke,[Ze,a(p,{modelValue:e.formArticulo.cod_barra,"onUpdate:modelValue":o[0]||(o[0]=l=>e.formArticulo.cod_barra=l),modelModifiers:{trim:!0},type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",eo,[oo,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.iva,"onUpdate:modelValue":o[1]||(o[1]=l=>e.formArticulo.iva=l),options:["SI","NO"]},null,8,["modelValue"])]),t("div",lo,[ao,a(p,{filled:"",modelValue:e.formArticulo.fecha_caducidad,"onUpdate:modelValue":o[3]||(o[3]=l=>e.formArticulo.fecha_caducidad=l),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:s(()=>[a(H,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(Ae,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(be,{modelValue:e.formArticulo.fecha_caducidad,"onUpdate:modelValue":o[2]||(o[2]=l=>e.formArticulo.fecha_caducidad=l),locale:e.myLocale},{default:s(()=>[t("div",to,[oe(a(P,{label:"Cerrar",color:"primary",flat:""},null,512),[[le]])])]),_:1},8,["modelValue","locale"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",so,[ro,a(p,{modelValue:e.formArticulo.principio_activo,"onUpdate:modelValue":o[4]||(o[4]=l=>e.formArticulo.principio_activo=l),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",io,[no,a(p,{modelValue:e.formArticulo.producto,"onUpdate:modelValue":o[5]||(o[5]=l=>e.formArticulo.producto=l),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",uo,[co,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",onFilter:e.filterFnCategories,"use-input":"","input-debounce":"0",modelValue:e.formArticulo.categoria_id,"onUpdate:modelValue":o[7]||(o[7]=l=>e.formArticulo.categoria_id=l),options:e.listCategorias},{append:s(()=>[a(P,{round:"",dense:"",flat:"",icon:"add",onClick:o[6]||(o[6]=se(l=>e.modalAgregarCategoria=!0,["stop","prevent"]))})]),"no-option":s(()=>[a(K,null,{default:s(()=>[a(Z,{class:"text-grey"},{default:s(()=>[h(" No hay resultados ")]),_:1})]),_:1})]),_:1},8,["onFilter","modelValue","options"])]),t("div",mo,[po,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",onFilter:e.filterFnLaboratorios,"use-input":"","input-debounce":"0",modelValue:e.formArticulo.laboratorio_id,"onUpdate:modelValue":o[9]||(o[9]=l=>e.formArticulo.laboratorio_id=l),options:e.listLaboratorios},{append:s(()=>[a(P,{round:"",dense:"",flat:"",icon:"add",onClick:o[8]||(o[8]=se(l=>e.modalAgregarLaboratorio=!0,["stop","prevent"]))})]),"no-option":s(()=>[a(K,null,{default:s(()=>[a(Z,{class:"text-grey"},{default:s(()=>[h(" No hay resultados ")]),_:1})]),_:1})]),_:1},8,["onFilter","modelValue","options"])]),t("div",fo,[vo,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",onFilter:e.filterFn,"use-input":"","input-debounce":"0",modelValue:e.formArticulo.presentacion_id,"onUpdate:modelValue":o[11]||(o[11]=l=>e.formArticulo.presentacion_id=l),options:e.listPresentaciones},{append:s(()=>[a(P,{round:"",dense:"",flat:"",icon:"add",onClick:o[10]||(o[10]=se(l=>e.modalAgregarPresentacion=!0,["stop","prevent"]))})]),"no-option":s(()=>[a(K,null,{default:s(()=>[a(Z,{class:"text-grey"},{default:s(()=>[h(" No hay resultados ")]),_:1})]),_:1})]),_:1},8,["onFilter","modelValue","options"])]),t("div",go,[_o,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.punto_agregar,"onUpdate:modelValue":o[12]||(o[12]=l=>e.formArticulo.punto_agregar=l),options:e.listPV},null,8,["modelValue","options"])]),t("div",Ao,[t("div",bo,[t("label",null,[Vo,t("span",yo,w(e.totalCajas),1)]),t("label",ho,[wo,t("span",$o,w(e.totalFracciones),1)])])]),t("div",Po,[Co,a(p,{modelValue:e.formArticulo.f_caja,"onUpdate:modelValue":o[13]||(o[13]=l=>e.formArticulo.f_caja=l),modelModifiers:{trim:!0},type:"number",onChange:o[14]||(o[14]=l=>(e.calcularPrecioUnit(),e.cajasAndFracciones())),"input-class":"centrarTextoInput",min:"1",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",qo,[Fo,a(p,{modelValue:e.formArticulo.f_total,"onUpdate:modelValue":o[15]||(o[15]=l=>e.formArticulo.f_total=l),modelModifiers:{trim:!0},onChange:e.cajasAndFracciones,type:"number",min:"1",dense:"",filled:"",required:"","input-class":"centrarTextoInput"},null,8,["modelValue","onChange"])]),t("div",Uo,[t("div",ko,[Eo,a(p,{modelValue:e.formArticulo.pvm,"onUpdate:modelValue":o[16]||(o[16]=l=>e.formArticulo.pvm=l),modelModifiers:{trim:!0},"input-class":"centrarTextoInput",type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",Mo,[Lo,a(p,{modelValue:e.formArticulo.pvp,"onUpdate:modelValue":o[17]||(o[17]=l=>e.formArticulo.pvp=l),modelModifiers:{trim:!0},onChange:e.calcularPrecioUnit,type:"number",step:"0.01",maxlength:"3",dense:"",filled:"",required:"","input-class":"centrarTextoInput"},null,8,["modelValue","onChange"])]),t("div",Io,[So,a(p,{modelValue:e.formArticulo.p_unitario,"onUpdate:modelValue":o[18]||(o[18]=l=>e.formArticulo.p_unitario=l),modelModifiers:{trim:!0},"input-class":"resaltarTextoInput",type:"number",readonly:"",dense:"",filled:""},null,8,["modelValue"])]),t("div",Do,[jo,a(p,{modelValue:e.formArticulo.descuento,"onUpdate:modelValue":o[19]||(o[19]=l=>e.formArticulo.descuento=l),modelModifiers:{trim:!0},type:"number","input-class":"centrarTextoInput",dense:"",filled:"",required:"",min:"0",max:"100"},null,8,["modelValue"])])]),t("div",To,[a(P,{onClick:e.submit,loading:e.loading,label:"Guardar",class:"q-px-xl",color:"green-9"},null,8,["onClick","loading"])])])]),_:1})]),_:1})]),_:1}),a(W,{modelValue:e.modalAgregarPresentacion,"onUpdate:modelValue":o[20]||(o[20]=l=>e.modalAgregarPresentacion=l)},{default:s(()=>[a(i,{onGetPresentaciones:e.getPresentaciones},null,8,["onGetPresentaciones"])]),_:1},8,["modelValue"]),a(W,{modelValue:e.modalAgregarLaboratorio,"onUpdate:modelValue":o[21]||(o[21]=l=>e.modalAgregarLaboratorio=l)},{default:s(()=>[a(m,{onGetLaboratorios:e.getLaboratorios},null,8,["onGetLaboratorios"])]),_:1},8,["modelValue"]),a(W,{modelValue:e.modalAgregarCategoria,"onUpdate:modelValue":o[22]||(o[22]=l=>e.modalAgregarCategoria=l)},{default:s(()=>[a(V,{onGetCategorias:e.getCategorias},null,8,["onGetCategorias"])]),_:1},8,["modelValue"])],64)}var Qo=te(We,[["render",Oo]]);const No=ae({name:"EditarArticulo",props:["articuloData"],setup(e,{emit:o}){const f=ue(),{claim:{user:v}}=ie.read(f.token),{id:u,aplicaIva:F,cod_barra:i,producto:m,principio_activo:V,fxc:l,fracciones_total:U,fecha_caducidad:$,pvm:T,pvp:S,p_unit:Q,descuento:N,categoria_id:O,presentacion_id:_,laboratorio_id:R,pv_nombre:B}=e.articuloData;let j=$.split("T")[0].split("/");const D=`${j[2]}/${j[1]}/${j[0]}`,q=d({cod_barra:i,iva:F,principio_activo:V,producto:m,categoria_id:O,presentacion_id:_,laboratorio_id:R,f_caja:l,f_total:U,fecha_caducidad:D,pvm:T.toFixed(2),pvp:S.toFixed(2),p_unitario:Q.toFixed(2),descuento:N}),r=d(0),n=d(0),A=d([]),y=d([]),M=d([]),g=d([]),k=d(!1),Y=()=>{const c=(q.value.pvp/q.value.f_caja).toFixed(2),b=Math.floor(c*100)/100;q.value.p_unitario=b},z=()=>{const c=q.value.f_total,b=q.value.f_caja;r.value=c!==0?parseInt(c/b):0,n.value=c!==0?parseInt(c%b):0},{mostrarNotify:ye}=_e(),he=async()=>{try{const{data:{laboratorios:c}}=await C.get("/laboratorios/true");A.value=[],c.forEach(b=>{A.value.push({label:b.nombre,value:b.id})})}catch(c){console.log(c)}},we=async()=>{try{const{data:{categorias:c}}=await C.get("/categorias/true");y.value=[],c.forEach(b=>{y.value.push({label:b.nombre,value:b.id})})}catch(c){console.log(c)}k.value=!1},$e=async()=>{try{const{data:{presentaciones:c}}=await C.get("/presentaciones/true");M.value=[],c.forEach(b=>{M.value.push({label:b.nombre,value:b.id})})}catch(c){console.log(c)}k.value=!1},Pe=async()=>{try{const{data:{puntos_ventas:c}}=await C.get("/puntos_ventas/true");g.value=[],c.forEach(b=>{b.nombre!="OTROS-JEFE"&&g.value.push({label:b.nombre,value:b.id})}),g.value.unshift({label:"AGREGAR A TODOS",value:0})}catch(c){console.log(c)}k.value=!1};$e(),he(),we(),Pe(),z();const Ce=async()=>{try{k.value=!0,await C.put(`/articulos/${u}`,q.value),o("actualizarLista"),ye("positive","Articulo Editado Exitosamente"),k.value=!1}catch(c){console.log(c),k.value=!1}};return ne(q.value,(c,b)=>{q.value.producto=c.producto.toUpperCase()}),{calcularPrecioUnit:Y,listLaboratorios:A,listCategorias:y,listPresentaciones:M,listPV:g,loading:k,formArticulo:q,submit:Ce,totalCajas:r,totalFracciones:n,cajasAndFracciones:z,user:v,myLocale:{days:"Domingo_Lunes_Martes_Mi\xE9rcoles_Jueves_Viernes_S\xE1bado".split("_"),daysShort:"Dom_Lun_Mar_Mi\xE9_Jue_Vie_S\xE1b".split("_"),months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),firstDayOfWeek:1,format24h:!0,pluralDay:"dias"},pv_nombre:B}}}),Ro={class:"text-h6 text-center"},Bo={class:"row q-gutter-md"},zo={class:"offset-1 col-xs-10 col-sm-5"},Jo=t("label",null,"Codigo de Barra:",-1),Go={class:"col-xs-10 col-sm-5"},xo=t("label",null,"Aplica IVA:",-1),Ho={class:"offset-1 col-xs-10 col-sm-5"},Wo=t("label",null,"Principio Activo:",-1),Yo={class:"col-xs-10 col-sm-5"},Xo=t("label",null,"Producto:",-1),Ko={class:"offset-1 col-xs-10 col-sm-5"},Zo=t("label",null,"Categoria:",-1),el={class:"col-xs-10 col-sm-5"},ol=t("label",null,"Laboratorio:",-1),ll={class:"offset-1 col-xs-10 col-sm-5"},al=t("label",null,"Presentaci\xF3n:",-1),tl={class:"col-xs-10 col-sm-5"},sl=t("label",null,"Fecha de Caducidad:",-1),rl={class:"row items-center justify-end"},il={class:"offset-1 col-xs-10 col-sm-4",style:{display:"flex","align-items":"center","justify-content":"center"}},nl={class:"text-h5 q-mt-sm"},dl=t("span",{class:"text-green-10"},"C:",-1),ul={class:"text-weight-regular"},cl={class:"q-ml-xl"},ml=t("span",{class:"text-green-10"},"F:",-1),pl={class:"text-weight-regular"},fl={class:"col-xs-10 col-sm-2"},vl=t("label",null,"F. por caja:",-1),gl={class:"col-xs-10 col-sm-3"},_l=t("label",null,"Stock Fracciones:",-1),Al={class:"row q-gutter-md flex-center text-center"},bl={class:"col-xs-10 col-sm-2"},Vl=t("label",null,"PVM:",-1),yl={class:"col-xs-10 col-sm-2 text-center"},hl=t("label",null,"PVP:",-1),wl={class:"col-xs-10 col-sm-2 text-center"},$l=t("label",null,"P. Unitario:",-1),Pl={class:"col-xs-10 col-sm-2"},Cl=t("label",null,"Descuento %",-1),ql={class:"col-xs-9 col-sm-12 flex justify-center"};function Fl(e,o,f,v,u,F){return L(),G(ve,{style:{width:"700px","max-width":"80vw"}},{default:s(()=>[a(ee,{class:"row items-center q-pb-none text-center"},{default:s(()=>[t("div",Ro,"Editar Articulo - "+w(e.pv_nombre),1),a(de),oe(a(P,{icon:"close",flat:"",round:"",dense:""},null,512),[[le]])]),_:1}),a(ee,null,{default:s(()=>[a(Ve,null,{default:s(()=>[t("div",Bo,[t("div",zo,[Jo,a(p,{modelValue:e.formArticulo.cod_barra,"onUpdate:modelValue":o[0]||(o[0]=i=>e.formArticulo.cod_barra=i),modelModifiers:{trim:!0},type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",Go,[xo,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.iva,"onUpdate:modelValue":o[1]||(o[1]=i=>e.formArticulo.iva=i),options:["SI","NO"]},null,8,["modelValue"])]),t("div",Ho,[Wo,a(p,{modelValue:e.formArticulo.principio_activo,"onUpdate:modelValue":o[2]||(o[2]=i=>e.formArticulo.principio_activo=i),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",Yo,[Xo,a(p,{modelValue:e.formArticulo.producto,"onUpdate:modelValue":o[3]||(o[3]=i=>e.formArticulo.producto=i),modelModifiers:{trim:!0},dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",Ko,[Zo,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.categoria_id,"onUpdate:modelValue":o[4]||(o[4]=i=>e.formArticulo.categoria_id=i),options:e.listCategorias},null,8,["modelValue","options"])]),t("div",el,[ol,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.laboratorio_id,"onUpdate:modelValue":o[5]||(o[5]=i=>e.formArticulo.laboratorio_id=i),options:e.listLaboratorios},null,8,["modelValue","options"])]),t("div",ll,[al,a(I,{filled:"",required:"",dense:"","emit-value":"","map-options":"",modelValue:e.formArticulo.presentacion_id,"onUpdate:modelValue":o[6]||(o[6]=i=>e.formArticulo.presentacion_id=i),options:e.listPresentaciones},null,8,["modelValue","options"])]),t("div",tl,[sl,a(p,{filled:"",modelValue:e.formArticulo.fecha_caducidad,"onUpdate:modelValue":o[8]||(o[8]=i=>e.formArticulo.fecha_caducidad=i),dense:"",mask:"date",clearable:"","clear-icon":"close"},{append:s(()=>[a(H,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(Ae,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(be,{modelValue:e.formArticulo.fecha_caducidad,"onUpdate:modelValue":o[7]||(o[7]=i=>e.formArticulo.fecha_caducidad=i),locale:e.myLocale},{default:s(()=>[t("div",rl,[oe(a(P,{label:"Cerrar",color:"primary",flat:""},null,512),[[le]])])]),_:1},8,["modelValue","locale"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",il,[t("div",nl,[t("label",null,[dl,t("span",ul,w(e.totalCajas),1)]),t("label",cl,[ml,t("span",pl,w(e.totalFracciones),1)])])]),t("div",fl,[vl,a(p,{modelValue:e.formArticulo.f_caja,"onUpdate:modelValue":o[9]||(o[9]=i=>e.formArticulo.f_caja=i),modelModifiers:{trim:!0},type:"number",onChange:o[10]||(o[10]=i=>(e.calcularPrecioUnit(),e.cajasAndFracciones())),"input-class":"centrarTextoInput",min:"1",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",gl,[_l,a(p,{modelValue:e.formArticulo.f_total,"onUpdate:modelValue":o[11]||(o[11]=i=>e.formArticulo.f_total=i),modelModifiers:{trim:!0},onChange:e.cajasAndFracciones,type:"number",min:"1",dense:"",filled:"",required:"","input-class":"centrarTextoInput"},null,8,["modelValue","onChange"])]),t("div",Al,[t("div",bl,[Vl,a(p,{modelValue:e.formArticulo.pvm,"onUpdate:modelValue":o[12]||(o[12]=i=>e.formArticulo.pvm=i),modelModifiers:{trim:!0},"input-class":"centrarTextoInput",type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),t("div",yl,[hl,a(p,{modelValue:e.formArticulo.pvp,"onUpdate:modelValue":o[13]||(o[13]=i=>e.formArticulo.pvp=i),modelModifiers:{trim:!0},onChange:e.calcularPrecioUnit,type:"number",step:"0.01",maxlength:"3",dense:"",filled:"",required:"","input-class":"centrarTextoInput"},null,8,["modelValue","onChange"])]),t("div",wl,[$l,a(p,{modelValue:e.formArticulo.p_unitario,"onUpdate:modelValue":o[14]||(o[14]=i=>e.formArticulo.p_unitario=i),modelModifiers:{trim:!0},"input-class":"resaltarTextoInput",type:"number",readonly:"",dense:"",filled:""},null,8,["modelValue"])]),t("div",Pl,[Cl,a(p,{modelValue:e.formArticulo.descuento,"onUpdate:modelValue":o[15]||(o[15]=i=>e.formArticulo.descuento=i),modelModifiers:{trim:!0},type:"number","input-class":"centrarTextoInput",dense:"",filled:"",required:"",min:"0",max:"100"},null,8,["modelValue"])])]),t("div",ql,[a(P,{onClick:e.submit,loading:e.loading,label:"Editar",class:"q-px-xl",color:"green-9"},null,8,["onClick","loading"])])])]),_:1})]),_:1})]),_:1})}var Ul=te(No,[["render",Fl]]);const kl=[{name:"acciones",label:"acciones",align:"center"},{name:"pv_name",label:"Punto de Venta",align:"center",field:"pv_name"},{name:"cod_barra",label:"Codigo de Barra",align:"center",field:"cod_barra"},{name:"producto",label:"Producto",align:"center",field:"producto"},{name:"prin_act",label:"Principio Activo",align:"center",field:"principio_activo"},{name:"f/c",label:"Fraccion * Caja",align:"center",field:"fxc",style:"width: 100px"},{name:"c_t",label:"Total cajas",align:"center",field:"c_t",style:"width: 100px"},{name:"f_t",label:"Fracciones Total",align:"center",field:"f_t",style:"width: 100px"},{name:"f_c",label:"Fecha de Caducidad",align:"center",field:"fecha_caducidad"},{name:"iva",label:"Aplica Iva",align:"center",field:"iva"},{name:"estado",label:"Estado",align:"center"}],El=ae({name:"IndexArticulo",components:{AgregarArticulo:Qo,EditarArticulo:Ul,FiltrarArticulos:He},setup(){const{validarPermisos:e}=ze(),o=ue(),{claim:{user:f}}=ie.read(o.token),v=d(null),u=d({page:"",rowsPerPage:"",pv_id:0,tipoBusqueda:"codigo",busqueda:""}),F=d(!1),i=d(!1),m=d(!1),V=Me(),l=Qe(),U=d([]),$=d([]),T=d("codigo"),S=d(""),Q=d(""),N=d(),O=d(!1),_=d({sortBy:"desc",descending:!1,page:1,rowsPerPage:7,rowsNumber:10}),R=(r=null)=>{D(0,_.value.rowsPerPage,r)},B=async r=>{try{l.dialog({title:"Deseas Eliminar este articulo?",message:"Una vez eliminado no podra recuperarse...!",ok:{push:!0,label:"Eliminar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{re.show({message:"Cargando..."}),await C.delete(`/articulos/${r}`),D(0,_.value.rowsPerPage,null),l.notify({color:"positive",message:"Articulo Eliminado Exitosamente",icon:"done",position:"top-right"}),re.hide()})}catch(n){re.hide(),l.notify({color:"warning",message:n.response.data.message,icon:"error",position:"top-right"})}},j=async r=>{v.value=r,m.value=!0},D=async(r,n,A=null)=>{i.value=!1,m.value=!1;let y=0;var M=[];S.value==""?y="sin-busqueda":y=S.value,f.rol_name!="ADMINISTRADOR"&&f.rol_name!="SUPER-ADMINISTRADOR"&&(Q.value=f.pv_id);try{if(A==null){const{data:g}=await C.post("/articulos/contarArticulos",{page:r,rowsPerPage:n,tipoBusqueda:u.value.tipoBusqueda,busqueda:y,pv_id:u.value.pv_id});M=g.articulos,g.articulos.length!=0?_.value.rowsNumber=g.articulos[0].totalArticulos:_.value.rowsNumber=0}else M=A.articulos,A.articulos.length==0?_.value.rowsNumber=0:_.value.rowsNumber=A.articulos[0].totalArticulos;M.map(g=>{const k=g.fracciones_total,Y=g.fxc;g.totalCajas=k!==0?parseInt(k/Y):0,g.totalFracciones=k!==0?parseInt(k%Y):0;let z=g.fecha_caducidad.split("T")[0].split("-");g.fecha_caducidad=`${z[2]}/${z[1]}/${z[0]}`}),$.value=M}catch(g){console.log(g)}};async function q(r){u.value.busqueda=S.value;const{page:n,rowsPerPage:A,sortBy:y,descending:M}=r.pagination;O.value=!0;const g=(n-1)*A;await D(g,A),$.value.length!=0?_.value.rowsNumber=$.value[0].totalArticulos:_.value.rowsNumber=0,_.value.page=n,_.value.rowsPerPage=A,_.value.sortBy=y,_.value.descending=M,O.value=!1}return Le(()=>{N.value.requestServerInteraction()}),ne(T,(r,n)=>{u.value.tipoBusqueda=r,D(0,_.value.rowsPerPage,null)}),{articuloData:v,actualizarLista:R,columns:kl,date:Oe,editarArticulo:j,eliminarArticulo:B,getArticulos:D,filter:S,formFiltrarArticulo:u,modalAgregarArticulo:i,modalEditarArticulo:m,modalFiltrarArticulo:F,loading:O,originalRows:U,router:V,rows:$,tableRef:N,tipoBusqueda:T,onRequest:q,pagination:_,validarPermisos:e,user:f}}}),Ml={class:"row q-py-lg q-pl-md"},Ll={class:"col-md-2 flex justify-end"},Il={class:"row"},Sl={class:"col-md-12 col-xs-12"},Dl={class:"q-px-md q-pt-none"},jl=t("label",null,"Filtrar por:",-1),Tl={key:0},Ol={key:1},Ql=t("br",null,null,-1),Nl={class:"full-width row flex-center text-lime-10 q-gutter-sm"},Rl=t("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun Resultado ",-1);function Bl(e,o,f,v,u,F){const i=J("FiltrarArticulos"),m=J("AgregarArticulo"),V=J("EditarArticulo");return L(),x(ge,null,[a(je,null,{default:s(()=>[t("div",Ml,[a(i,{pagination:e.pagination,formFiltrarArticulo:e.formFiltrarArticulo,user:e.user,onActualizarLista:e.actualizarLista},null,8,["pagination","formFiltrarArticulo","user","onActualizarLista"]),t("div",Ll,[e.validarPermisos("Agregar Articulo")&&!e.$q.screen.xs?(L(),G(P,{key:0,color:"secondary","icon-right":"add_circle",class:"q-mr-md",label:"Nuevo",onClick:o[0]||(o[0]=l=>e.modalAgregarArticulo=!0)})):X("",!0)])]),t("div",Il,[t("div",Sl,[t("div",Dl,[a(Se,{class:"my-sticky-header-table",ref:"tableRef",rows:e.rows,columns:e.columns,filter:e.filter,"row-key":"id",pagination:e.pagination,"onUpdate:pagination":o[3]||(o[3]=l=>e.pagination=l),loading:e.loading,"rows-per-page-options":[3,7,15,0],"binary-state-sort":"",onRequest:e.onRequest},{top:s(()=>[jl,a(Ie,{modelValue:e.tipoBusqueda,"onUpdate:modelValue":o[1]||(o[1]=l=>e.tipoBusqueda=l),inline:"",style:{"margin-bottom":"0px"},class:"q-mb-md q-mr-md",options:[{label:"CODIGO",value:"codigo"},{label:"NOMBRE",value:"nombre"}]},null,8,["modelValue"]),a(de),a(p,{dense:"",debounce:"1000",color:"primary",modelValue:e.filter,"onUpdate:modelValue":o[2]||(o[2]=l=>e.filter=l),modelModifiers:{trim:!0}},{append:s(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),body:s(l=>[a(Je,{props:l},{default:s(()=>[a(E,{key:"acciones",props:l},{default:s(()=>[e.validarPermisos("Editar Articulo")&&l.row.estado?(L(),G(P,{key:0,round:"",color:"blue-grey",icon:"edit",class:"q-mr-sm",onClick:U=>e.editarArticulo(l.row),size:"10px"},null,8,["onClick"])):X("",!0),e.validarPermisos("Eliminar Articulo")&&l.row.estado?(L(),G(P,{key:1,round:"",color:"blue-grey",icon:"close",onClick:U=>e.eliminarArticulo(l.row.id),size:"10px"},null,8,["onClick"])):X("",!0)]),_:2},1032,["props"]),a(E,{key:"pv_name",props:l},{default:s(()=>[h(w(l.row.pv_nombre),1)]),_:2},1032,["props"]),a(E,{key:"cod_barra",props:l},{default:s(()=>[h(w(l.row.cod_barra),1)]),_:2},1032,["props"]),a(E,{key:"producto",props:l},{default:s(()=>[h(w(l.row.producto),1)]),_:2},1032,["props"]),a(E,{key:"prin_act",props:l},{default:s(()=>[h(w(l.row.principio_activo),1)]),_:2},1032,["props"]),a(E,{key:"f/c",props:l},{default:s(()=>[h(w(l.row.fxc),1)]),_:2},1032,["props"]),a(E,{key:"c_t",props:l},{default:s(()=>[h(w(l.row.totalCajas),1)]),_:2},1032,["props"]),a(E,{key:"f_t",props:l},{default:s(()=>[h(w(l.row.totalFracciones),1)]),_:2},1032,["props"]),a(E,{key:"f_c",props:l},{default:s(()=>[h(w(l.row.fecha_caducidad),1)]),_:2},1032,["props"]),a(E,{key:"iva",props:l},{default:s(()=>[h(w(l.row.aplicaIva),1)]),_:2},1032,["props"]),a(E,{key:"estado",props:l},{default:s(()=>[a(De,{outline:"",class:"q-py-xs q-px-md",color:l.row.estado?"positive":"dark"},{default:s(()=>[l.row.estado?(L(),x("span",Tl," En Stock ")):(L(),x("span",Ol,[h(" Vendido "),Ql,h(" "+w(l.row.fecha_venta),1)]))]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),"no-data":s(({icon:l,filter:U})=>[t("div",Nl,[a(H,{size:"2em",name:"sentiment_dissatisfied"}),Rl,a(H,{size:"2em",name:U?"filter_b_and_w":l},null,8,["name"])])]),_:1},8,["rows","columns","filter","pagination","loading","onRequest"])])])])]),_:1}),a(W,{modelValue:e.modalAgregarArticulo,"onUpdate:modelValue":o[5]||(o[5]=l=>e.modalAgregarArticulo=l),persistent:""},{default:s(()=>[a(m,{onActualizarLista:o[4]||(o[4]=l=>e.getArticulos(0,e.pagination.rowsPerPage,null))})]),_:1},8,["modelValue"]),a(W,{modelValue:e.modalEditarArticulo,"onUpdate:modelValue":o[7]||(o[7]=l=>e.modalEditarArticulo=l)},{default:s(()=>[a(V,{articuloData:e.articuloData,onActualizarLista:o[6]||(o[6]=l=>e.getArticulos(0,e.pagination.rowsPerPage,null))},null,8,["articuloData"])]),_:1},8,["modelValue"]),e.$q.screen.xs&&e.validarPermisos("Agregar Articulo")?(L(),G(Te,{key:0,position:"bottom-right",offset:[18,18]},{default:s(()=>[a(P,{round:"",color:"secondary",size:"lg",icon:"add",onClick:o[8]||(o[8]=l=>e.modalAgregarArticulo=!0)})]),_:1})):X("",!0)],64)}var ia=te(El,[["render",Bl]]);export{ia as default};
