import{d as S,r as c,C as I,_ as N,o as u,aa as v,g as i,f as a,aW as A,e as n,Q as V,h as C,aX as P,ae as Q,c as E,ab as $,aT as D,ag as z,bg as L,aV as R,i as k,ac as B,ad as T}from"./index.e02e0fd9.js";import{Q as j}from"./QSpace.290b7cf2.js";import{Q as M,a as h}from"./QTable.7676999b.js";import{Q as U}from"./QBadge.5c85781b.js";import{Q as F}from"./QPage.b9acbce1.js";import{Q as O}from"./QPageSticky.51a05daf.js";import{A as w}from"./Api.e3a65a9d.js";import{u as H}from"./useRolPermisos.82749469.js";import{a as W,u as X}from"./useHelpers.6f57171d.js";import{A as G}from"./Add.1abc63ee.js";import{e as J}from"./QList.ffb79e57.js";import{Q as K}from"./QForm.0c336d83.js";import"./index.2cf0d985.js";const Y=S({name:"EditarCliente",props:["clienteData"],setup(e,{emit:o}){const{id:f,nombres:b,direccion:p,tipo_documento:y,num_documento:t,celular:g,email:l}=e.clienteData,s=c(!1),r=c({id:f,nombres:b,tipo_documento:y,num_documento:t,email:l,celular:g,direccion:p}),_=W(),d=async()=>{try{if(s.value=!0,r.value.tipo_documento=="")return s.value=!1,_.notify({color:"negative",message:"Debes elegir un tipo de documento",icon:"warning"});if(r.value.num_documento.length!=10&&r.value.tipo_documento=="Cedula")return s.value=!1,_.notify({color:"negative",message:"El numero de Cedula debe tener un total de 10 digitos",icon:"warning"});if(r.value.num_documento.length!=13&&r.value.tipo_documento=="RUC")return s.value=!1,_.notify({color:"negative",message:"El numero de RUC debe tener un total de 13 digitos",icon:"warning"});await w.put("/clientes",r.value),o("actualizarLista"),_.notify({color:"positive",message:"Cliente Editado Exitosamente",icon:"done"}),s.value=!1}catch(m){console.log(m),s.value=!1}};return I(r.value,(m,q)=>{r.value.nombres=m.nombres.toUpperCase()}),{formCliente:r,loading:s,onSubmit:d,options:["Cedula","RUC","Pasaporte"]}}}),Z=n("div",{class:"text-h6"},"Editar Cliente",-1),x={class:"row q-gutter-sm justify-around"},ee={class:"col-xs-12 col-sm-11"},le=n("label",null,"Razon Social:",-1),oe={class:"col-xs-12 col-sm-5 q-my-md"},ae=n("label",null,"Tipo de Documento:",-1),ne={class:"col-xs-12 col-sm-5 q-my-md"},te=n("label",null,"Numero de Documento:",-1),ie={class:"col-xs-12 col-sm-5 q-my-md"},se=n("label",null,"Email:",-1),re={class:"col-xs-12 col-sm-5 q-my-md"},de=n("label",null,"Celular:",-1),me={class:"col-xs-12 col-sm-11"},ue=n("label",null,"Direcci\xF3n:",-1),ce={class:"col-xs-9 col-sm-12 flex justify-center"};function fe(e,o,f,b,p,y){return u(),v(P,{style:{width:"600px","max-width":"80vw"}},{default:i(()=>[a(A,null,{default:i(()=>[Z]),_:1}),a(A,null,{default:i(()=>[a(K,{onSubmit:e.onSubmit},{default:i(()=>[n("div",x,[n("div",ee,[le,a(V,{modelValue:e.formCliente.nombres,"onUpdate:modelValue":o[0]||(o[0]=t=>e.formCliente.nombres=t),dense:"",filled:"",required:""},null,8,["modelValue"])]),n("div",oe,[ae,a(J,{modelValue:e.formCliente.tipo_documento,"onUpdate:modelValue":o[1]||(o[1]=t=>e.formCliente.tipo_documento=t),filled:"",options:e.options},null,8,["modelValue","options"])]),n("div",ne,[te,a(V,{modelValue:e.formCliente.num_documento,"onUpdate:modelValue":o[2]||(o[2]=t=>e.formCliente.num_documento=t),modelModifiers:{trim:!0},type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),n("div",ie,[se,a(V,{modelValue:e.formCliente.email,"onUpdate:modelValue":o[3]||(o[3]=t=>e.formCliente.email=t),modelModifiers:{trim:!0},type:"email",dense:"",filled:"",required:""},null,8,["modelValue"])]),n("div",re,[de,a(V,{modelValue:e.formCliente.celular,"onUpdate:modelValue":o[4]||(o[4]=t=>e.formCliente.celular=t),modelModifiers:{trim:!0},type:"number",dense:"",filled:"",required:""},null,8,["modelValue"])]),n("div",me,[ue,a(V,{modelValue:e.formCliente.direccion,"onUpdate:modelValue":o[5]||(o[5]=t=>e.formCliente.direccion=t),dense:"",filled:"",required:""},null,8,["modelValue"])]),n("div",ce,[a(C,{loading:e.loading,label:"Editar",class:"q-px-xl",type:"submit",color:"green-9"},null,8,["loading"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})}var pe=N(Y,[["render",fe]]);const ge=[{name:"id",label:"#",align:"left",field:"id",sortable:!0},{name:"nombres",align:"center",label:"Cliente",field:"nombres",sortable:!0},{name:"tipo_documento",align:"center",label:"Tipo de Documento",field:"tipo_documento"},{name:"num_documento",align:"center",label:"Numero de Documento",field:"num_documento"},{name:"email",label:"Email",field:"email",align:"center"},{name:"celular",label:"Celular",field:"celular",align:"center"},{name:"estado",label:"Estado",align:"center",field:"estado"},{name:"acciones",label:"acciones",align:"center"}],ve=S({name:"IndexCliente",components:{Add:G,Editar:pe},setup(){const{validarPermisos:e}=H(),o=c(""),f=c([]),b=c(!1),p=c(!1),y=c({}),{mostrarNotify:t}=X(),g=c(!1),l=async()=>{b.value=!1,p.value=!1,g.value=!0;try{f.value=[];const{data:{clientes:d}}=await w.get("/clientes");d.forEach(m=>{m.nombres!="CONSUMIDOR FINAL"&&f.value.push(m)})}catch(d){console.log(d)}g.value=!1},s=async(d,m)=>{try{await w.delete(`/clientes/${d}/${m}`),t("positive","Cliente eliminado exitosamente"),l()}catch(q){console.log(q)}},r=async d=>{L.create({title:"\xBFDeseas Eliminar este cliente?",message:"Una vez eliminado no podra recuperarse...!",ok:{push:!0,label:"Eliminar",color:"teal-7"},cancel:{push:!0,color:"blue-grey-8",label:"Cancelar"}}).onOk(async()=>{try{await w.delete(`/clientes/${d}`),t("positive","Cliente eliminado exitosamente"),l()}catch(m){t("negative",m.response.data.message)}})},_=d=>{y.value=d,p.value=!0};return l(),{editarCliente:_,modalAgregarCliente:b,modalEditarCliente:p,activarDesactivarCliente:s,columns:ge,filter:o,loading:g,getClientes:l,eliminarCliente:r,isPwd:c(!0),rows:f,clienteData:y,validarPermisos:e}}}),Ce=n("div",{class:"col-md-6"},[n("label",{class:"text-h6"},"Listado de Clientes")],-1),be={class:"col-md-6 flex justify-end"},ye={class:"row"},_e={class:"col-md-12 col-xs-12"},Ve={class:"q-pa-md"},we={class:"full-width row flex-center text-lime-10 q-gutter-sm"},$e=n("span",{class:"text-subtitle1"}," No se encontr\xF3 ningun Resultado ",-1);function ke(e,o,f,b,p,y){const t=Q("Add"),g=Q("Editar");return u(),E(z,null,[a(F,null,{default:i(()=>[n("div",{class:R(["row q-py-lg q-pl-md",e.$q.screen.xs?"justify-center":"justify-between"])},[Ce,n("div",be,[e.validarPermisos("Agregar Cliente")&&!e.$q.screen.xs?(u(),v(C,{key:0,color:"secondary","icon-right":"person_add",label:"Agregar Cliente",class:"q-mr-md",onClick:o[0]||(o[0]=l=>e.modalAgregarCliente=!e.modalAgregarCliente)})):$("",!0)])],2),n("div",ye,[n("div",_e,[n("div",Ve,[a(M,{class:"my-sticky-header-table",rows:e.rows,columns:e.columns,filter:e.filter,loading:e.loading,"row-key":"name"},{top:i(()=>[a(j),a(V,{dense:"",debounce:"300",color:"primary",modelValue:e.filter,"onUpdate:modelValue":o[1]||(o[1]=l=>e.filter=l)},{append:i(()=>[a(k,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-id":i(l=>[a(h,{props:l},{default:i(()=>[B(T(l.pageIndex+1),1)]),_:2},1032,["props"])]),"body-cell-estado":i(l=>[a(h,{props:l},{default:i(()=>[l.value?(u(),v(U,{key:0,outline:"",color:"positive",label:"Activo",class:"q-pa-sm"})):(u(),v(U,{key:1,outline:"",color:"red",label:"Inactivo",class:"q-pa-sm"}))]),_:2},1032,["props"])]),"body-cell-acciones":i(l=>[a(h,{props:l},{default:i(()=>[e.validarPermisos("Editar Cliente")?(u(),v(C,{key:0,round:"",color:"primary",onClick:s=>e.editarCliente(l.row),icon:"edit",class:"q-mr-sm",size:"11px"},null,8,["onClick"])):$("",!0),l.row.estado?(u(),v(C,{key:1,round:"",color:"blue-grey",icon:"close",onClick:s=>e.activarDesactivarCliente(l.row.id,!1),size:"11px"},null,8,["onClick"])):(u(),E(z,{key:2},[a(C,{round:"",color:"positive",class:"q-mr-sm",icon:"done",onClick:s=>e.activarDesactivarCliente(l.row.id,!0),size:"11px"},null,8,["onClick"]),a(C,{round:"",color:"deep-orange",icon:"delete",onClick:s=>e.eliminarCliente(l.row.id),size:"11px"},null,8,["onClick"])],64))]),_:2},1032,["props"])]),"no-data":i(({icon:l,filter:s})=>[n("div",we,[a(k,{size:"2em",name:"sentiment_dissatisfied"}),$e,a(k,{size:"2em",name:s?"filter_b_and_w":l},null,8,["name"])])]),_:1},8,["rows","columns","filter","loading"])])])])]),_:1}),e.$q.screen.xs&&e.validarPermisos("Agregar Cliente")?(u(),v(O,{key:0,position:"bottom-right",offset:[18,18]},{default:i(()=>[a(C,{round:"",color:"secondary",size:"lg",icon:"add",onClick:o[2]||(o[2]=l=>e.modalAgregarCliente=!e.modalAgregarCliente)})]),_:1})):$("",!0),a(D,{modelValue:e.modalAgregarCliente,"onUpdate:modelValue":o[3]||(o[3]=l=>e.modalAgregarCliente=l)},{default:i(()=>[a(t,{onActualizarLista:e.getClientes},null,8,["onActualizarLista"])]),_:1},8,["modelValue"]),a(D,{modelValue:e.modalEditarCliente,"onUpdate:modelValue":o[4]||(o[4]=l=>e.modalEditarCliente=l)},{default:i(()=>[a(g,{clienteData:e.clienteData,onActualizarLista:e.getClientes},null,8,["clienteData","onActualizarLista"])]),_:1},8,["modelValue"])],64)}var Re=N(ve,[["render",ke]]);export{Re as default};
